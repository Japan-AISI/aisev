# 自動レッドチーミング 説明書

本説明書では、自動レッドチーミング機能の概要と利用手順を説明します。


# 概要

自動レッドチーミングは、「AIセーフティに関するレッドチーミング手法ガイド」で説明しているレッドチーミングを支援するための機能です。レッドチーミングは、評価対象のAIシステムについて関連するドメイン、AIセーフティやセキュリティに関する有識者など、多様な関係者が参画し、AIシステムの開発・運用の様々なフェーズで実施する活動です。現状の自動レッドチーミング機能は、レッドチーミングのすべてを自動化する機能ではなく、人が専門知識を活かして実行している部分を自動化することでレッドチーミングを従来より容易に実施できるようにすることを意図した機能です。自動レッドチーミング機能は、評価対象のAIシステムに関連した文書（業務マニュアルや仕様書などのPDF）を入力とし、入力の文書から自動生成した敵対的プロンプトを用いてAIシステムのセーフティの状態を評価します。具体的には、以下の順序で評価を行います。

1. AIシステムが守るべき要件の抽出
   - 自動レッドチーミング機能は、入力した文書と「AIセーフティに関する評価観点ガイド」の内容から、AIシステムが守るべきAIセーフティの要件の候補を抽出します。
2. 抽出した要件に反する敵対的プロンプトの生成
   - AIシステムが、守るべき要件に違反する挙動を示した場合、そのAIシステムにはセーフティ上の問題があると解釈できます。
   - 自動レッドチーミング機能は、AIシステムが要件に反した出力をするように仕向ける敵対的プロンプトを生成します。
3. 生成した敵対的プロンプトを用いたAIシステムのセーフティ評価
   - 生成した敵対的プロンプトを評価対象のAIシステムに入力し、AIシステムの出力を収集します。
   - 収集した出力と要件を比較し、要件を守っているかどうかを判定します。
   - 要件を守っていない出力が存在する場合、対応する敵対的プロンプトに関して何らかの脆弱性があると解釈できます。


# 自動レッドチーミングのセットアップ

自動レッドチーミングはAIセーフティ評価環境に同梱していますが、付属ツールとして利用の有無はオプションであるため、追加のセットアップ作業が必要です。

## セットアップ手順

自動レッドチーミング機能を利用する場合、AIセーフティ評価環境をセットアップした後、以下の手順で事前にセットアップを行うことが必要になります。

1. ターミナルを開き、評価環境のフォルダにある`llm-evaluation-system`フォルダへcdコマンドで移動してください。
   ```
   cd llm-evaluation-system/
   ```

2. ターミナル上で以下のコマンドを実行することにより、評価環境連携サービスのDockerコンテナを作成してください。
   ```
   docker compose build
   ```

3. ターミナル上で以下のコマンドを実行することにより、作成した評価環境連携サービスのDockerコンテナを起動します。`manager-backend`というコンテナ名で起動されます。  
   ```
   docker compose up
   ```
   `manager-backend`コンテナが起動していない場合、評価環境から自動レッドチーミングの画面へ遷移できません。

4. 評価環境のホーム画面で **自動レッドチーミングツール**ボタンを押してください。
   
5. 自動レッドチーミングの初期画面が表示されます。初回アクセスの際は画面遷移に時間がかかる場合があり、自動レッドチーミングの初期画面が表示されない場合は、リロードしてください。


# 利用手順

手順の途中で前の画面に戻る場合は、ステップナビゲーションを使用してください。
評価の途中でブラウザを閉じるとデータは保存されません。
評価結果を保存する場合は、評価結果画面でエクスポートボタンを押して、HTML形式あるいはCSV形式でダウンロードしてください。

1. **「①LLMの設定」画面:**  自動レットチーミングツールの初期画面で、**LLM 設定モーダルを開く**を押す。
2. 「LLM設定」画面で、「要件生成AI」、「敵対的プロンプト生成AI」、「応答評価AI」「ターゲットAI」のそれぞれに必要項目を入力する。
3. **保存**ボタンを押す。
4. **「②ドキュメントのアップロード」画面:** 必要に応じてファイルをアップロードする。
5. **次のステップへ進む**ボタンを押す。
6. **「③要件の生成」画面:** 以下を設定する
   - **ターゲット AI の使用目的:** ここにターゲット AI の使用目的を記載する。例えば、「この LLM は顧客サポートチャットボットとして使用され、製品情報の提供や一般的な質問に回答します。」
   - **生成する要件の数:** 任意の数に設定する。
   - ファイルをアップロードしていない場合は、「アップロードしたドキュメントを使用する」のチェックを外す。
7. **要件を生成**ボタンを押す。
8. 要件が生成されたら、**次のステップへ進む**ボタンを押す。
9. **「④敵対的プロンプトの生成」画面:** 「要件毎に生成するプロンプト数」を任意の数に設定する。但し、3 以上の場合、回答を拒否される場合が多い。
10. **敵対的プロンプトを生成**ボタンを押す。
11. 生成されたプロンプトが表示されたら、**次のステップへ進む**ボタンを押す。
12. **「⑤評価の実行」画面:** **評価を実行**ボタンを押す。
13. 評価が終了したら**評価結果を表示**ボタンを押す。
14. 「評価結果」画面で評価結果を確認する。

